<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Inyección de dependencia | Cristian Baños Yelmo</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Inyección de dependencia" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Inyección de dependencia" />
<meta property="og:description" content="Inyección de dependencia" />
<link rel="canonical" href="http://localhost:4000/entorno/de/desarrollo/2019/04/06/inyeccion-de-dependencia.html" />
<meta property="og:url" content="http://localhost:4000/entorno/de/desarrollo/2019/04/06/inyeccion-de-dependencia.html" />
<meta property="og:site_name" content="Cristian Baños Yelmo" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-04-06T22:30:29+02:00" />
<script type="application/ld+json">
{"description":"Inyección de dependencia","@type":"BlogPosting","url":"http://localhost:4000/entorno/de/desarrollo/2019/04/06/inyeccion-de-dependencia.html","headline":"Inyección de dependencia","dateModified":"2019-04-06T22:30:29+02:00","datePublished":"2019-04-06T22:30:29+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/entorno/de/desarrollo/2019/04/06/inyeccion-de-dependencia.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Cristian Baños Yelmo" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Cristian Baños Yelmo</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Inyección de dependencia</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2019-04-06T22:30:29+02:00" itemprop="datePublished">Apr 6, 2019
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h2 id="inyección-de-dependencia">Inyección de dependencia</h2>
<hr />

<p>Este término viene a usarse más comunmente desde la aparición de frameworks como Spring.</p>

<p>Con la inyección de dependencias conseguimos que nuestras piezas de software sean independientes y se comuniquen mediante un interface. Esto nos lleva a suprimir instanciaciones de objetos con la instrucción new.</p>

<p>En este ejemplo <strong>A</strong> debe inicializar la dependencia <strong>b</strong>:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span>  <span class="nc">A</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="n">B</span> <span class="n">b</span><span class="o">;</span>
	<span class="kd">public</span> <span class="nf">A</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">b</span> <span class="o">=</span> <span class="k">new</span> <span class="n">B</span><span class="o">();</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>En cambio aquí, tenemos inyección de dependencia, <strong>A</strong> deja de ser la responsable de la inicialización y es ahora responsable quien crea A de informar al objeto <strong>b</strong>.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">A</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="n">B</span> <span class="n">b</span><span class="o">;</span>
	<span class="kd">public</span> <span class="nf">A</span><span class="o">(</span><span class="n">B</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">b</span> <span class="o">=</span> <span class="n">b</span><span class="o">;</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>También la podemos encontrar en el uso de los <code class="highlighter-rouge">seter</code> :</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">A</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="n">B</span> <span class="n">b</span><span class="o">;</span>

	<span class="o">...</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">bSet</span><span class="o">(</span><span class="n">B</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">b</span> <span class="o">=</span> <span class="n">b</span><span class="o">;</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Al buscar esa independencia de cada pieza de código, mediante el uso de interfaces, podemos modificar una pieza de software por otro sin necesidad de reprogramar las clases que hacen uso de él.</p>

<p>Del código OtroProyDI:</p>

<p><code class="highlighter-rouge">DAOCategory.java</code></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="n">productservlet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">DAOCategory</span><span class="o">{</span>
  <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">listaNombreCat</span><span class="o">();</span>
  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">valida</span><span class="o">(</span><span class="n">String</span> <span class="n">cat</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">DAOCategoryImplFile.java</code></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="n">productservlet</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.BufferedWriter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.FileWriter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.File</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.FileReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.BufferedReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.enterprise.inject.Alternative</span><span class="o">;</span>

<span class="nd">@Alternative</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DAOCategoryImplFile</span> <span class="kd">implements</span> <span class="n">DAOCategory</span><span class="o">{</span>
  <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">listaNombreCat</span><span class="o">()</span> <span class="o">{</span>
     <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
     <span class="n">FileReader</span> <span class="n">fileReader</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
     <span class="k">try</span> <span class="o">{</span>
      <span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="s">"/tmp/CategoryFile"</span><span class="o">);</span>
      <span class="n">fileReader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="n">file</span><span class="o">);</span>
      <span class="n">BufferedReader</span> <span class="n">bufferedReader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="n">fileReader</span><span class="o">);</span>
      <span class="n">String</span> <span class="n">line</span><span class="o">;</span>
      <span class="k">while</span> <span class="o">((</span><span class="n">line</span> <span class="o">=</span> <span class="n">bufferedReader</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
             <span class="n">result</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">line</span><span class="o">);</span>
      <span class="o">}</span>
     <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
         <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
     <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
         <span class="n">fileReader</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
         <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
     <span class="o">}</span>
     <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">valida</span><span class="o">(</span><span class="n">String</span> <span class="n">cat</span><span class="o">)</span> <span class="o">{</span>
     <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
     <span class="n">result</span><span class="o">=</span><span class="n">listaNombreCat</span><span class="o">();</span>
     <span class="k">for</span><span class="o">(</span><span class="n">String</span> <span class="n">st</span> <span class="o">:</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span><span class="n">st</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">cat</span><span class="o">))</span> <span class="o">{</span>
          <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span>
     <span class="o">}</span>
     <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">DAOCategoryImplRedis.java</code></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="n">productservlet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">redis.clients.jedis.Jedis</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.enterprise.inject.Alternative</span><span class="o">;</span>

<span class="nd">@Alternative</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DAOCategoryImplRedis</span> <span class="kd">implements</span> <span class="n">DAOCategory</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">listaNombreCat</span><span class="o">()</span> <span class="o">{</span>
  <span class="c1">//  List&lt;String&gt; result = new ArrayList&lt;String&gt;();</span>
    <span class="n">Jedis</span> <span class="n">conn</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Jedis</span><span class="o">(</span><span class="s">"localhost"</span><span class="o">);</span>
    <span class="n">conn</span><span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="mi">4</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">conn</span><span class="o">.</span><span class="na">lrange</span><span class="o">(</span><span class="s">"listaCategory"</span><span class="o">,</span><span class="mi">0</span><span class="o">,-</span><span class="mi">1</span><span class="o">);</span>
  <span class="o">}</span>
 
  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">valida</span><span class="o">(</span><span class="n">String</span> <span class="n">cat</span><span class="o">)</span> <span class="o">{</span>
     <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
     <span class="n">result</span><span class="o">=</span><span class="n">listaNombreCat</span><span class="o">();</span>
     <span class="k">for</span><span class="o">(</span><span class="n">String</span> <span class="n">st</span> <span class="o">:</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span><span class="n">st</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">cat</span><span class="o">))</span> <span class="o">{</span>
          <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span>
     <span class="o">}</span>
     <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Es decir al crear la interface <strong>DAOCategory</strong> podemos hacer uso de los métodos <code class="highlighter-rouge">public List&lt;String&gt; listaNombreCat();</code> <code class="highlighter-rouge">public boolean valida(String cat);</code>, de cualquiera de las dos anteriores implementaciones, que no hará falta recompilar las demás clases de este proyecto.</p>

<p>Otro uso de inyección de dependencia lo podemos encontrar a la hora de usar frameworks como Spring.</p>

<p>En el ejemplo visto en clase de la banda:</p>

<p><code class="highlighter-rouge">App.java</code></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.springframework.context.ApplicationContext</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.support.ClassPathXmlApplicationContext</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">App</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">PerformanceException</span> <span class="o">{</span>
		<span class="n">ApplicationContext</span> <span class="n">context</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ClassPathXmlApplicationContext</span><span class="o">(</span>
				<span class="s">"SpringBeans.xml"</span><span class="o">);</span>

		<span class="n">Performer</span> <span class="n">performer</span> <span class="o">=</span> <span class="o">(</span><span class="n">Performer</span><span class="o">)</span> <span class="n">context</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="s">"kenny"</span><span class="o">);</span>
		<span class="n">performer</span><span class="o">.</span><span class="na">perform</span><span class="o">();</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p><code class="highlighter-rouge">SpringBeans.xml</code></p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">"http://www.springframework.org/schema/beans"</span>
	<span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
	<span class="na">xsi:schemaLocation=</span><span class="s">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd"</span><span class="nt">&gt;</span>

	<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"kenny"</span> <span class="na">class=</span><span class="s">"OneManBandMap"</span><span class="nt">&gt;</span>
	  <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"instruments"</span><span class="nt">&gt;</span>
	    <span class="nt">&lt;map&gt;</span>
	      <span class="nt">&lt;entry</span> <span class="na">key=</span><span class="s">"SAXO"</span> <span class="na">value-ref=</span><span class="s">"sax"</span><span class="nt">/&gt;</span>
	      <span class="nt">&lt;entry</span> <span class="na">key=</span><span class="s">"PIAN"</span> <span class="na">value-ref=</span><span class="s">"pia"</span><span class="nt">/&gt;</span>
	      <span class="nt">&lt;entry</span> <span class="na">key=</span><span class="s">"CORN"</span> <span class="na">value-ref=</span><span class="s">"cor"</span><span class="nt">/&gt;</span>
	    <span class="nt">&lt;/map&gt;</span>	
	  <span class="nt">&lt;/property&gt;</span>
	<span class="nt">&lt;/bean&gt;</span>
	<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"sax"</span> <span class="na">class=</span><span class="s">"Saxophone"</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"pia"</span> <span class="na">class=</span><span class="s">"Piano"</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"cor"</span> <span class="na">class=</span><span class="s">"Corneta"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/beans&gt;</span>
</code></pre></div></div>

<p>En <strong>App.java</strong> va a buscar en el bean las clases que debe usar, aquí encontramos la inyección de dependencia, ya que podríamos borrar <code class="highlighter-rouge">&lt;entry key="CORN" value-ref="cor"/&gt;</code> y no haría falta recompilar el código o en el caso de añadir otro instrumento p.e.<code class="highlighter-rouge">&lt;bean id="tro" class="Trompeta"/&gt;</code> <code class="highlighter-rouge">&lt;entry key="TROM" value-ref="tro"/&gt;</code>.</p>

<p>En resumen, con la inyección de dependencia nuestro código es más modular que esto a su vez nos facilita y ahorra tiempo en hacer test unitarios. También escribimos código más rápido al quitar la necesidad de tener que instanciar objetos.</p>

<p>Por otro lado, la inyección de dependencia puede ser tediosa, por la abstracción del código, al tener que crear una interfaz y sus implementaciones. Sin olvidar que tenemos que configurar los inyectores.</p>


  </div><a class="u-url" href="/entorno/de/desarrollo/2019/04/06/inyeccion-de-dependencia.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Cristian Baños Yelmo</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Cristian Baños Yelmo</li><li><a class="u-email" href="mailto:cristianyelmo@gmail.com">cristianyelmo@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/CristianBY"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">CristianBY</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Estudiante en CFGS 1ºDAW IES Polígono Sur</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
